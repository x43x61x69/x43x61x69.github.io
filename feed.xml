<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title></title>
        <description></description>
        <link>https://one.vg/</link>
        <atom:link href="https://one.vg/feed.xml" rel="self" type="application/rss+xml"/>
        <pubDate>Thu, 09 Jun 2022 11:49:12 +0800</pubDate>
        <lastBuildDate>Thu, 09 Jun 2022 11:49:12 +0800</lastBuildDate>
        <generator>Jekyll v4.2.2</generator>
        
            <item>
                <title>在 Apple Silicon Mac 上運行 macOS Ventura 預覽版虛擬機</title>
                <description>&lt;p&gt;從 macOS 12「Monterey」開始，Apple 設計了 &lt;em&gt;&lt;a href=&quot;https://developer.apple.com/documentation/virtualization&quot;&gt;Virtualization 虛擬化框架&lt;/a&gt;&lt;/em&gt;，提供高階 APIs 用以於 Apple Silicon 和 Intel 架構的 Mac 電腦上建立和管理虛擬機。對 Intel 架構的 Mac 而言並沒有實際使用的必要，因為第三方商用虛擬機器監視器（Hypervisor）更加先進且具備更多功能；然而不幸的是，對於 Apple Silicon 架構的 Mac 來說，這是至本文撰寫為止唯一的 macOS 虛擬化方案。&lt;/p&gt;

&lt;p&gt;然而，目前的 Virtualization 框架本身相當原始且有諸多限制，包含但不限於下列的項目：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;不支援安裝任何早於 macOS Monterey 的系統版本（因為 Virtualization 框架在其後才推出）。&lt;/li&gt;
  &lt;li&gt;於 macOS Monterey 上嘗試使用 macOS Ventura 的 IPSW（還原映像檔）安裝虛擬機會發生錯誤性崩潰。&lt;/li&gt;
  &lt;li&gt;無法完整客製化虛擬機硬體，僅能映射實體主機。&lt;/li&gt;
  &lt;li&gt;虛擬機內無法登入系統 Apple ID。&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;現在你大概可以理解為何 Apple Silicon 上目前尚無商業化的 macOS 虛擬化解決方案：這些 API 目前在本質上難以實用化。但撇除這些限制，虛擬機運行得相當不錯且相較於 Intel 架構的 Mac 而言速度驚人的快。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/71ac2589-ded9-4fd0-8fdc-6a8fd1d93948_001.jpg&quot; alt=&quot;macOS VM with Virtualization framework&quot; /&gt;
&lt;em&gt;macOS Ventura 虛擬機運行於 Apple Silicon 架構的 MacBook Pro。&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;事前準備&quot;&gt;事前準備&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;一台 Apple Silicon 架構的 Mac 電腦。&lt;/li&gt;
  &lt;li&gt;因為本篇教學建立在 Apple 的範例專案上，你需要具備基礎的程式設計（不論是 Objective-C 亦或是 Swift）能力。&lt;/li&gt;
  &lt;li&gt;一個 Apple ID 帳號作為開發者帳號，用於程式簽章。&lt;/li&gt;
  &lt;li&gt;Xcode 的基本使用知識，以及 Xcode 13 或更新的版本。&lt;/li&gt;
  &lt;li&gt;一份&lt;a href=&quot;https://developer.apple.com/documentation/virtualization/running_macos_in_a_virtual_machine_on_apple_silicon_macs&quot;&gt;官方範例專案&lt;/a&gt;。&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;現在我們可以開始安裝啦！&lt;/p&gt;

&lt;h2 id=&quot;設定虛擬機&quot;&gt;設定虛擬機&lt;/h2&gt;

&lt;p&gt;雖然官方的範例專案本身可以直接執行，你可能會想要先行調整部分設定參數以便更硬體符合需求。之後的文章內容將會以 Swfit 版本的程式碼作為範例，但 Objective-C 版本差異並不大，可自行推敲。&lt;/p&gt;

&lt;h4 id=&quot;安裝路徑&quot;&gt;安裝路徑&lt;/h4&gt;

&lt;p&gt;欲修改預設的安裝路徑，檢視「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Path.swift&lt;/code&gt;」並作適當的修改。預設會將虛擬機安裝至使用者目錄下的「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;VM.bundle&lt;/code&gt;」。&lt;/p&gt;

&lt;h4 id=&quot;處理器核心數&quot;&gt;處理器核心數&lt;/h4&gt;

&lt;p&gt;欲修改分配給虛擬機的處理器核心數，請修改「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MacOSVirtualMachineConfigurationHelper.swift&lt;/code&gt;」中的函式「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;computeCPUCount()&lt;/code&gt;」：&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;computeCPUCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;totalAvailableCPUs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ProcessInfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;processInfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;processorCount&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;virtualCPUCount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;totalAvailableCPUs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;totalAvailableCPUs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;virtualCPUCount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;virtualCPUCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZVirtualMachineConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minimumAllowedCPUCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;virtualCPUCount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;virtualCPUCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZVirtualMachineConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maximumAllowedCPUCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;virtualCPUCount&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;預設程式會使用你所有的核心數減去 1 個核。你也可以用演算的方式搭配 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.maximumAllowedCPUCount&lt;/code&gt; 來動態產生最佳數值。&lt;/p&gt;

&lt;h4 id=&quot;記憶體&quot;&gt;記憶體&lt;/h4&gt;

&lt;p&gt;欲修改分配給虛擬機的記憶體數值，請修改「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MacOSVirtualMachineConfigurationHelper.swift&lt;/code&gt;」中的函式「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;computeMemorySize()&lt;/code&gt;」：&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;computeMemorySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;UInt64&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// We arbitrarily choose 4GB.&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;memorySize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;UInt64&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;memorySize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;memorySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZVirtualMachineConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minimumAllowedMemorySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;memorySize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;memorySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZVirtualMachineConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maximumAllowedMemorySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;memorySize&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;預設程式分配 4GB 的記憶體。你也可以用演算的方式搭配 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.maximumAllowedMemorySize&lt;/code&gt; 來動態產生最佳數值。&lt;/p&gt;

&lt;h4 id=&quot;顯示器解析度以及點距ppi&quot;&gt;顯示器解析度以及點距（PPI）&lt;/h4&gt;

&lt;p&gt;Virtualization 框架目前尚未支援動態解析度調整。欲修改虛擬機的顯示器解析度以及點距，請修改「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MacOSVirtualMachineConfigurationHelper.swift&lt;/code&gt;」中的函式「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;createGraphicsDeviceConfiguration()&lt;/code&gt;」：&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;createGraphicsDeviceConfiguration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZMacGraphicsDeviceConfiguration&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;graphicsConfiguration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZMacGraphicsDeviceConfiguration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;graphicsConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;displays&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// We abitrarily choose the resolution of the display to be 1920 x 1200.&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;VZMacGraphicsDisplayConfiguration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;widthInPixels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1920&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;heightInPixels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;pixelsPerInch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;graphicsConfiguration&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;例如，14 英吋的 MacBook Pro 螢幕點距為 284，請依照你的實際硬體做修改。修改後將啟用高解析度（HiDPI，即 Retina）模式。&lt;/p&gt;

&lt;h4 id=&quot;磁碟大小&quot;&gt;磁碟大小&lt;/h4&gt;

&lt;p&gt;預設的虛擬磁碟大小為 64GB。欲調整分配給虛擬機的磁碟空間，請修改「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MacOSVirtualMachineInstaller.swift&lt;/code&gt;」中的函式「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;createDiskImage()&lt;/code&gt;」：&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;createDiskImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;diskFd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;diskImagePath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;O_RDWR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;O_CREAT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;S_IRUSR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;S_IWUSR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;diskFd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;fatalError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Cannot create disk image.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// 64GB disk space.&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ftruncate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;diskFd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;fatalError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ftruncate() failed.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;diskFd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;fatalError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Failed to close the disk image.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;請至少分配 64GB 的磁碟空間予虛擬機，以確保運行穩定。&lt;/p&gt;

&lt;p&gt;當然，還有其他可以做調整的參數，不過並沒有前面提及的這些重要。&lt;/p&gt;

&lt;h2 id=&quot;安裝-macos-monterey&quot;&gt;安裝 macOS Monterey&lt;/h2&gt;

&lt;p&gt;一旦完成設定，請執行「InstallationTool」來進行初始化。此工具會嘗試取得目前實體 Mac 主機公開發佈的最新 macOS 版本。你也可以修改原始碼來強制使用其他的 IPSW 檔案，不過由於目前僅有 Monterey 可供下載，我們可以不做更動。&lt;/p&gt;

&lt;p&gt;安裝完成後，接著執行「macOSVirtualMachineSampleApp」。程式將於新視窗中啟動剛才安裝好的 macOS 虛擬機。&lt;/p&gt;

&lt;h2 id=&quot;安裝-macos-ventura-預覽版&quot;&gt;安裝 macOS Ventura 預覽版&lt;/h2&gt;

&lt;p&gt;當你可以操作虛擬機時，開啟 Safari 並下載&lt;a href=&quot;/tw/blog/install-macos-ventura-beta-in-vmware-fusion#obtain-the-macos-ventura-installer&quot;&gt;此處&lt;/a&gt;的「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;InstallAssistant.pkg&lt;/code&gt;」macOS Ventura 安裝程式。目前透過 Apple 開發者網站取得之「macOS Developer Beta Access Utility」會發生錯誤而無法透過系統更新直接升級至 macOS Ventura 預覽版。&lt;/p&gt;

&lt;p&gt;安裝下載完成的 PKG 檔案，接著開啟位於應用程式資料夾中的「Install macOS 13 beta.app」來開始 macOS 安裝。有鑒於 macOS Ventura 大幅度變更了系統偏好設定的介面，這裡建議先在目前的環境下做好所需的系統設定後再進行升級安裝。&lt;/p&gt;

&lt;p&gt;接著等待安裝完成。你現在應該有一台能夠在 Apple Silicon 架構的 Mac 上正常操作的 macOS Ventura 虛擬機。&lt;/p&gt;
</description>
                <pubDate>Thu, 09 Jun 2022 10:43:14 +0800</pubDate>
                <link>https://one.vg/tw/blog/running-macos-ventura-in-a-virtual-machine-on-apple-silicon-macs</link>
                <guid isPermaLink="true">https://one.vg/tw/blog/running-macos-ventura-in-a-virtual-machine-on-apple-silicon-macs</guid>
                
                <category>Mac</category>
                
                
                <category>tw</category>
                
            </item>
        
            <item>
                <title>Running macOS Ventura Beta in a Virtual Machine on Apple Silicon Macs</title>
                <description>&lt;p&gt;Since macOS 12 “Monterey”, Apple has created the &lt;em&gt;&lt;a href=&quot;https://developer.apple.com/documentation/virtualization&quot;&gt;Virtualization framework&lt;/a&gt;&lt;/em&gt; which provides high-level APIs for creating and managing virtual machines (VM) on Apple silicon and Intel-based Macs. For Intel-based Macs, there is no necessity for using it, as 3rd-party commercial hypervisors are way more advanced and more feature-rich. Unfortunately for Apple silicon Macs, this seems to be the only way to virtualize macOS at the time of writing.&lt;/p&gt;

&lt;p&gt;However, the current version of Virtualization framework is pretty bare-bone and has many limitations, including but not limited to:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Any macOS version prior to macOS Monterey isn’t supported (as the Virtualization framework was introduced in Monterey).&lt;/li&gt;
  &lt;li&gt;It will crash if you try to use the IPSW (restore image file) of macOS Ventura for installation on a macOS Monterey host.&lt;/li&gt;
  &lt;li&gt;There’s no way to fully customized the virtual hardware but only reflect hardware of the host machine.&lt;/li&gt;
  &lt;li&gt;You can’t sign-in Apple ID in the VM.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Now you might be able to comprehend why there’s no commercial-grade 3rd-party virtualization software for macOS on Apple silicon: the APIs were just too hard to work with at this time. But other than those limitations, it works quite well and is amazingly fast compares to its Intel-based counterpart.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/71ac2589-ded9-4fd0-8fdc-6a8fd1d93948_001.jpg&quot; alt=&quot;macOS VM with Virtualization framework&quot; /&gt;
&lt;em&gt;macOS Ventura VM running on an Apple silicon MacBook Pro.&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;pre-requirements&quot;&gt;Pre-requirements&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;An Apple silicon Mac.&lt;/li&gt;
  &lt;li&gt;As this guide is based on an Apple sample project, basic knowledge of programming (for either Objective-C or Swift) is required.&lt;/li&gt;
  &lt;li&gt;An Apple ID as developer account for code-signing.&lt;/li&gt;
  &lt;li&gt;Basic knowledge of Xcode and have Xcode 13 or later installed.&lt;/li&gt;
  &lt;li&gt;A copy of &lt;a href=&quot;https://developer.apple.com/documentation/virtualization/running_macos_in_a_virtual_machine_on_apple_silicon_macs&quot;&gt;this sample project&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Now we can start the installation!&lt;/p&gt;

&lt;h2 id=&quot;configure-the-virtual-machine&quot;&gt;Configure the Virtual Machine&lt;/h2&gt;

&lt;p&gt;Although the sample project itself works out of the box, you might want to adjust some of the configurations. The rest of the guide will use Swift version as example, but Objective-C version is pretty similar.&lt;/p&gt;

&lt;h4 id=&quot;installation-path&quot;&gt;Installation Path&lt;/h4&gt;

&lt;p&gt;To change the hardcoded installation path, look into “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Path.swift&lt;/code&gt;” and edit the path as you please. By default, it will install into “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;VM.bundle&lt;/code&gt;” in your home folder.&lt;/p&gt;

&lt;h4 id=&quot;cpu-cores&quot;&gt;CPU Cores&lt;/h4&gt;

&lt;p&gt;To change the allocate CPU cores for the VM, look for function “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;computeCPUCount()&lt;/code&gt;” in “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MacOSVirtualMachineConfigurationHelper.swift&lt;/code&gt;”:&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;computeCPUCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;totalAvailableCPUs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ProcessInfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;processInfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;processorCount&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;virtualCPUCount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;totalAvailableCPUs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;totalAvailableCPUs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;virtualCPUCount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;virtualCPUCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZVirtualMachineConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minimumAllowedCPUCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;virtualCPUCount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;virtualCPUCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZVirtualMachineConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maximumAllowedCPUCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;virtualCPUCount&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;By default, it will use your total available cores minus 1. You can also calculate the optimal value dynamically with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.maximumAllowedCPUCount&lt;/code&gt;.&lt;/p&gt;

&lt;h4 id=&quot;memory&quot;&gt;Memory&lt;/h4&gt;

&lt;p&gt;To change the allocate memory for the VM, look for function “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;computeMemorySize()&lt;/code&gt;” in “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MacOSVirtualMachineConfigurationHelper.swift&lt;/code&gt;”:&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;computeMemorySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;UInt64&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// We arbitrarily choose 4GB.&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;memorySize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;UInt64&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;memorySize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;memorySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZVirtualMachineConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minimumAllowedMemorySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;memorySize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;memorySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZVirtualMachineConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maximumAllowedMemorySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;memorySize&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;By default the value is 4GB. Instead of hardcode the memory size, you can also calculate the optimal size dynamically with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.maximumAllowedMemorySize&lt;/code&gt;.&lt;/p&gt;

&lt;h4 id=&quot;display-resolution-and-ppi&quot;&gt;Display Resolution and PPI&lt;/h4&gt;

&lt;p&gt;The Virtualization framework has yet to support dynamic resolutions. To change the display resolution and PPI, look for function “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;createGraphicsDeviceConfiguration()&lt;/code&gt;” in “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MacOSVirtualMachineConfigurationHelper.swift&lt;/code&gt;”:&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;createGraphicsDeviceConfiguration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZMacGraphicsDeviceConfiguration&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;graphicsConfiguration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZMacGraphicsDeviceConfiguration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;graphicsConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;displays&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// We abitrarily choose the resolution of the display to be 1920 x 1200.&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;VZMacGraphicsDisplayConfiguration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;widthInPixels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1920&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;heightInPixels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;pixelsPerInch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;graphicsConfiguration&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For example, the PPI for 14” MacBook Pro is 284. Change it to enable HiDPI (Retina) mode.&lt;/p&gt;

&lt;h4 id=&quot;disk-size&quot;&gt;Disk Size&lt;/h4&gt;

&lt;p&gt;The default disk size of the VM is 64GB. To change it, look for function “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;createDiskImage()&lt;/code&gt;” in “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MacOSVirtualMachineInstaller.swift&lt;/code&gt;”:&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;createDiskImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;diskFd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;diskImagePath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;O_RDWR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;O_CREAT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;S_IRUSR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;S_IWUSR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;diskFd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;fatalError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Cannot create disk image.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// 64GB disk space.&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ftruncate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;diskFd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;fatalError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ftruncate() failed.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;diskFd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;fatalError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Failed to close the disk image.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You should allocate at least 64GB of the disk space for stability.&lt;/p&gt;

&lt;p&gt;Of course, there are other settings that you can play around, but they were not as important.&lt;/p&gt;

&lt;h2 id=&quot;install-macos-monterey&quot;&gt;Install macOS Monterey&lt;/h2&gt;

&lt;p&gt;Once configured, run the “InstallationTool” will initiate the process. It will try to obtain the latest copy that’s public available to the host Mac. You can modified the source code to force it to use other IPSW, but as currently there’s only Monterey available, we can just leave it as it is.&lt;/p&gt;

&lt;p&gt;After the installation, fire up “macOSVirtualMachineSampleApp”. It should open a window with the macOS Monterey VM we just installed.&lt;/p&gt;

&lt;h2 id=&quot;install-macos-ventura-beta&quot;&gt;Install macOS Ventura Beta&lt;/h2&gt;

&lt;p&gt;Once you have access to the VM, open Safari and download the macOS Ventura installer “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;InstallAssistant.pkg&lt;/code&gt;” &lt;a href=&quot;/blog/install-macos-ventura-beta-in-vmware-fusion#obtain-the-macos-ventura-installer&quot;&gt;here&lt;/a&gt;. At the moment, the “macOS Developer Beta Access Utility” available on the Apple Developer website will result in errors so you won’t be able to upgrade directly.&lt;/p&gt;

&lt;p&gt;Install the PKG file you just downloaded, then open the “Install macOS 13 beta.app” in your Applications folder to start the macOS installation. As macOS Ventura greatly alter the System Preferences UI, it’s recommended to have everything setup before you upgrade.&lt;/p&gt;

&lt;p&gt;Wait until the installation finish. You should now have a working macOS Ventura VM on your Apple silicon Mac.&lt;/p&gt;
</description>
                <pubDate>Thu, 09 Jun 2022 10:43:14 +0800</pubDate>
                <link>https://one.vg/blog/running-macos-ventura-in-a-virtual-machine-on-apple-silicon-macs</link>
                <guid isPermaLink="true">https://one.vg/blog/running-macos-ventura-in-a-virtual-machine-on-apple-silicon-macs</guid>
                
                <category>Mac</category>
                
                
            </item>
        
            <item>
                <title>在 VMware Fusion 中安裝 macOS Ventura 預覽版</title>
                <description>&lt;p&gt;macOS 13 「Ventura」預覽版已於 WWDC 2022 正式發表。如果你想測試新系統帶來的全新功能而不影響到目前既有的工作流程，選擇透過虛擬機安裝測試版本的 macOS 是一個不錯的做法。&lt;/p&gt;

&lt;p&gt;因為日常工作上經常會用到 VMware vSphere，所以選擇同門的 Fusion 作為 macOS 平台的虛擬化解決方案對我而言再自然不過。不幸的是，從 macOS Monterey 開始 VMware Fusion 就有許多小問題而無法正確的初始化系統安裝。這篇教學的目的便是教你如何順利的透過 VMware Fusion 安裝 將 macOS Ventura。&lt;/p&gt;

&lt;h2 id=&quot;事前準備&quot;&gt;事前準備&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;（建議為）搭載 Intel 處理器且&lt;a href=&quot;https://www.apple.com/tw/macos/macos-ventura-preview/&quot;&gt;可以執行 macOS Ventura&lt;/a&gt; 的 Mac。&lt;/li&gt;
  &lt;li&gt;macOS Ventura 的安裝磁碟（稍後詳述）。&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.vmware.com/go/getfusion&quot;&gt;VMware Fusion 12.2&lt;/a&gt; 或更新的版本。&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;請留意，雖然技術上可以透過 &lt;a href=&quot;https://customerconnect.vmware.com/downloads/get-download?downloadGroup=FUS-PUBTP-2021H1&quot;&gt;VMware Fusion 技術預覽版&lt;/a&gt;於 ARM 架構的 Mac 上安裝 macOS Ventura，然而安裝 macOS 於本文撰寫時仍未獲得官方正式支援。如欲安裝，請參考&lt;a href=&quot;/tw/blog/running-macos-ventura-in-a-virtual-machine-on-apple-silicon-macs&quot;&gt;此處&lt;/a&gt;的教學。&lt;/p&gt;

&lt;h2 id=&quot;取得-macos-ventura-安裝磁碟&quot;&gt;取得 macOS Ventura 安裝磁碟&lt;/h2&gt;

&lt;p&gt;截至本文撰寫時，目前僅有&lt;a href=&quot;https://developer.apple.com/download/&quot;&gt;開發者預覽版&lt;/a&gt;（Developer Beta）可供下載，且需要訂閱 Apple 開發者會員方能合法取得。如果你不具有 Apple 開發者會員資格，你也可以等待日後的&lt;a href=&quot;https://beta.apple.com/sp/betaprogram&quot;&gt;公開預覽版&lt;/a&gt;（Public Beta）推出後再進行安裝。這裡強烈建議「不要」由任何非 Apple 的管道取得安裝磁碟以避免安全問題。&lt;/p&gt;

&lt;p&gt;下列為 Apple CDN 上的下載連結（請自行判斷相關風險）：&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;發布&lt;/th&gt;
      &lt;th&gt;版本&lt;/th&gt;
      &lt;th&gt;下載&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Beta 1&lt;/td&gt;
      &lt;td&gt;22A5266r&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://swcdn.apple.com/content/downloads/38/13/012-20267-A_8II0GZVCTD/vsifpgvw3a3xjgyznf6415vin9xv7a6ws5/InstallAssistant.pkg&quot;&gt;InstallAssistant.pkg&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;如果你是透過「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;macOS Developer Beta Access Utility&lt;/code&gt;」來取得安裝磁碟，切記在下載完成後自動開啟的安裝流程取消前先複製一份安裝程式以便免其遭到自動刪除。如果你選擇下載「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;InstallAssistant.pkg&lt;/code&gt;」，你必須先安裝它以便於「應用程式」資料夾中產生本教學所需要的「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Install macOS 13 beta.app&lt;/code&gt;」。&lt;/p&gt;

&lt;h2 id=&quot;製作安裝磁碟&quot;&gt;製作安裝磁碟&lt;/h2&gt;

&lt;p&gt;這個步驟以往都是透過 Fusion 自動完成。不過如前述，自 Monterey 發布以來它便無法正常運作，我們需要手動進行安裝磁碟的製作。&lt;/p&gt;

&lt;p&gt;請先確認「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Install macOS 13 beta.app&lt;/code&gt;」已位於「應用程式」資料夾中，且系統磁碟分區尚有至少 30GB 的可用空間。接著在終端機中透過下列指令建立映像檔（ISO）：&lt;/p&gt;

&lt;div class=&quot;language-zsh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;hdiutil create &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; /tmp/Ventura &lt;span class=&quot;nt&quot;&gt;-size&lt;/span&gt; 13650m &lt;span class=&quot;nt&quot;&gt;-volname&lt;/span&gt; Ventura &lt;span class=&quot;nt&quot;&gt;-layout&lt;/span&gt; SPUD &lt;span class=&quot;nt&quot;&gt;-fs&lt;/span&gt; HFS+J
hdiutil attach /tmp/Ventura.dmg &lt;span class=&quot;nt&quot;&gt;-noverify&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-mountpoint&lt;/span&gt; /Volumes/Ventura
&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; /Applications/Install&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;macOS&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;13&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;beta.app/Contents/Resources/createinstallmedia &lt;span class=&quot;nt&quot;&gt;--volume&lt;/span&gt; /Volumes/Ventura &lt;span class=&quot;nt&quot;&gt;--nointeraction&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;hdiutil detach &lt;span class=&quot;nt&quot;&gt;-force&lt;/span&gt; /Volumes/Install&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;macOS&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;Ventura
hdiutil convert /tmp/Ventura.dmg &lt;span class=&quot;nt&quot;&gt;-format&lt;/span&gt; UDTO &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; ~/Desktop/Ventura.cdr
&lt;span class=&quot;nb&quot;&gt;mv&lt;/span&gt; ~/Desktop/Ventura.cdr ~/Desktop/Ventura.iso
&lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; /tmp/Ventura.dmg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;如果操作正確，這時你的桌面上將會有一個名為「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Ventura.iso&lt;/code&gt;」的檔案。&lt;/p&gt;

&lt;p&gt;Apple 官方關於如何製作可開機的 macOS 安裝磁碟的教學請見&lt;a href=&quot;https://support.apple.com/zh-tw/HT201372&quot;&gt;此處&lt;/a&gt;。&lt;/p&gt;

&lt;h2 id=&quot;設定虛擬機&quot;&gt;設定虛擬機&lt;/h2&gt;

&lt;p&gt;請依 VMware Fusion 內的指示，利用剛才製作的映像檔建立一個新的虛擬機。作業系統請選擇「Apple OS X &amp;gt; macOS 11」，並自訂硬體設置（如果需要），接著儲存虛擬機（但先「不要」啟動）。&lt;/p&gt;

&lt;p&gt;接著於 &lt;em&gt;Virtual Machine Library&lt;/em&gt;（組合鍵 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Shift + CMD + L&lt;/code&gt;）中，在剛建立的虛擬機上按右鍵、將游標移至「Show in Finder」。此時按住「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Option&lt;/code&gt;」鍵，剛才游標位置的選單會變為「Open Config File in Editor」。點選選項將會於文字編輯器中開啟 VMX 檔案：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/8187bc26-3fab-4947-be03-2fac6c048001_001.gif&quot; alt=&quot;Edit VMX&quot; /&gt;&lt;/p&gt;

&lt;p&gt;於 VMX 檔案中新增下列內容（任意位置）：&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;appleGPU0.present = &quot;TRUE&quot;
svga.present = &quot;FALSE&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;這將會在之後顯著提升顯示效能。&lt;/p&gt;

&lt;p&gt;修復乙太網路功能，在檔案中搜尋下面這行：&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ethernet0.virtualDev = &quot;e1000e&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;將此行中的「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;e1000e&lt;/code&gt;」更改為「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vmxnet3&lt;/code&gt;」。&lt;/p&gt;

&lt;p&gt;如果你想，也可以新增下列內容來將 Mac 的實體型號映射至虛擬機：&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;serialNumber.reflectHost = &quot;TRUE&quot;
hw.model.reflectHost = &quot;TRUE&quot;
smbios.reflectHost = &quot;TRUE&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;完成後儲存 VMX 檔案並關閉編輯器。&lt;/p&gt;

&lt;h2 id=&quot;安裝-macos-ventura&quot;&gt;安裝 macOS Ventura&lt;/h2&gt;

&lt;p&gt;至此，你應該有辦法正常的如同先前的 macOS 版本一樣進行安裝！只要啟動虛擬機，並依照安裝流程指示操作。&lt;/p&gt;

&lt;p&gt;一旦安裝完成，安裝&lt;a href=&quot;https://customerconnect.vmware.com/en/downloads/info/slug/datacenter_cloud_infrastructure/vmware_tools/12_x&quot;&gt;此處&lt;/a&gt;的 VMware Tools 來代替內建的版本以便使用&lt;a href=&quot;https://kb.vmware.com/s/article/81657&quot;&gt;動態螢幕解析度&lt;/a&gt;功能。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/8187bc26-3fab-4947-be03-2fac6c048001_002.jpg&quot; alt=&quot;macOS Ventura&quot; /&gt;&lt;/p&gt;

&lt;p&gt;現在你有了一台功能完整的 macOS Ventura 虛擬機。&lt;/p&gt;
</description>
                <pubDate>Wed, 08 Jun 2022 14:54:24 +0800</pubDate>
                <link>https://one.vg/tw/blog/install-macos-ventura-beta-in-vmware-fusion</link>
                <guid isPermaLink="true">https://one.vg/tw/blog/install-macos-ventura-beta-in-vmware-fusion</guid>
                
                <category>Mac</category>
                
                
                <category>tw</category>
                
            </item>
        
            <item>
                <title>Install macOS Ventura Beta in VMware Fusion</title>
                <description>&lt;p&gt;macOS 13 “Ventura” beta has just been announced at the WWDC 2022. In case you want to test it out without breaking anything vital to your existing workflow, install it as a VM sounds like a great way to start.&lt;/p&gt;

&lt;p&gt;I use VMware vSphere on a daily basis for work, and it’s only nature for me to choose Fusion on macOS for virtualization. Unfortunately, since macOS Monterey, VMware Fusion has some issues preventing it from working as intended. This guide is to help you jump through all the necessary hoops in order to install macOS Ventura in VMware Fusion.&lt;/p&gt;

&lt;h2 id=&quot;pre-requirements&quot;&gt;Pre-requirements&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;(Preferably) an Intel Mac &lt;a href=&quot;https://www.apple.com/macos/macos-ventura-preview/&quot;&gt;supported by macOS Ventura&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;A copy of macOS Ventura installer (more on this later).&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.vmware.com/go/getfusion&quot;&gt;VMware Fusion 12.2&lt;/a&gt; or later.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Beware that, although technically it’s possible to install macOS Ventura in a VM on an ARM-based Mac with &lt;a href=&quot;https://customerconnect.vmware.com/downloads/get-download?downloadGroup=FUS-PUBTP-2021H1&quot;&gt;VMware Fusion Technical Preview&lt;/a&gt;, it isn’t officially supported at the time of writing. If you wish to install it on an Apple silicon Mac, check out &lt;a href=&quot;/blog/running-macos-ventura-in-a-virtual-machine-on-apple-silicon-macs&quot;&gt;this&lt;/a&gt; guide for more information.&lt;/p&gt;

&lt;h2 id=&quot;obtain-the-macos-ventura-installer&quot;&gt;Obtain the macOS Ventura Installer&lt;/h2&gt;

&lt;p&gt;At the time of writing, there’s only &lt;a href=&quot;https://developer.apple.com/download/&quot;&gt;Developer Beta&lt;/a&gt; version available and require an active Apple Developer Subscription to obtain the installer legally. If you do not have a developer subscription, you also can wait until the &lt;a href=&quot;https://beta.apple.com/sp/betaprogram&quot;&gt;Public Beta&lt;/a&gt; is available. I strongly recommend &lt;strong&gt;NOT&lt;/strong&gt; to download the installer from any source other than Apple for security reasons.&lt;/p&gt;

&lt;p&gt;Here are some links directly from Apple CDN (use them at your own risk):&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Release&lt;/th&gt;
      &lt;th&gt;Build&lt;/th&gt;
      &lt;th&gt;Download&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Beta 1&lt;/td&gt;
      &lt;td&gt;22A5266r&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://swcdn.apple.com/content/downloads/38/13/012-20267-A_8II0GZVCTD/vsifpgvw3a3xjgyznf6415vin9xv7a6ws5/InstallAssistant.pkg&quot;&gt;InstallAssistant.pkg&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;If you use the “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;macOS Developer Beta Access Utility&lt;/code&gt;” to get the installer, remember to make a copy of the app bundle somewhere first in case it got deleted once you cancel the installation. If you choose to get the “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;InstallAssistant.pkg&lt;/code&gt;”, you would need to install it first in order to get the required “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Install macOS 13 beta.app&lt;/code&gt;” within your Applications folder for this guide.&lt;/p&gt;

&lt;h2 id=&quot;create-the-installation-media&quot;&gt;Create the Installation Media&lt;/h2&gt;

&lt;p&gt;This was usually done automatically by Fusion. But as mentioned earlier, it’s broken since Monterey so we would’ve to do it manually.&lt;/p&gt;

&lt;p&gt;Make sure you the “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Install macOS 13 beta.app&lt;/code&gt;” is in your Applications folder and have at least 30GB of free space left on your system partition. Then use the following commands in the Terminal to create an ISO:&lt;/p&gt;

&lt;div class=&quot;language-zsh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;hdiutil create &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; /tmp/Ventura &lt;span class=&quot;nt&quot;&gt;-size&lt;/span&gt; 13650m &lt;span class=&quot;nt&quot;&gt;-volname&lt;/span&gt; Ventura &lt;span class=&quot;nt&quot;&gt;-layout&lt;/span&gt; SPUD &lt;span class=&quot;nt&quot;&gt;-fs&lt;/span&gt; HFS+J
hdiutil attach /tmp/Ventura.dmg &lt;span class=&quot;nt&quot;&gt;-noverify&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-mountpoint&lt;/span&gt; /Volumes/Ventura
&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; /Applications/Install&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;macOS&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;13&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;beta.app/Contents/Resources/createinstallmedia &lt;span class=&quot;nt&quot;&gt;--volume&lt;/span&gt; /Volumes/Ventura &lt;span class=&quot;nt&quot;&gt;--nointeraction&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;hdiutil detach &lt;span class=&quot;nt&quot;&gt;-force&lt;/span&gt; /Volumes/Install&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;macOS&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;Ventura
hdiutil convert /tmp/Ventura.dmg &lt;span class=&quot;nt&quot;&gt;-format&lt;/span&gt; UDTO &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; ~/Desktop/Ventura.cdr
&lt;span class=&quot;nb&quot;&gt;mv&lt;/span&gt; ~/Desktop/Ventura.cdr ~/Desktop/Ventura.iso
&lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; /tmp/Ventura.dmg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you have done it correctly, you should have a file named “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Ventura.iso&lt;/code&gt;” on your Desktop.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://support.apple.com/en-us/HT201372&quot;&gt;Here&lt;/a&gt; is the official guide for creating bootable installer.&lt;/p&gt;

&lt;h2 id=&quot;configure-the-vm&quot;&gt;Configure the VM&lt;/h2&gt;

&lt;p&gt;Simply create a new VM in Fusion with the ISO we just created. Select the operating system as “Apple OS X &amp;gt; macOS 11”, customize the hardware if needed then save it somewhere you prefer WITHOUT turning it on yet.&lt;/p&gt;

&lt;p&gt;Now select the VM you just created in the &lt;em&gt;Virtual Machine Library&lt;/em&gt; (open with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Shift + CMD + L&lt;/code&gt;), right click on it and move the cursor to “Show in Finder”. Now hold &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Option&lt;/code&gt; key, the item will change to “Open Config File in Editor”. Click on the item and the VMX file will be opened with TextEdit:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/8187bc26-3fab-4947-be03-2fac6c048001_001.gif&quot; alt=&quot;Edit VMX&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Add the following lines to the VMX file (doesn’t matter where):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;appleGPU0.present = &quot;TRUE&quot;
svga.present = &quot;FALSE&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This will greatly improves the graphic performance later on.&lt;/p&gt;

&lt;p&gt;To fix the eternet connection, find the follow line:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ethernet0.virtualDev = &quot;e1000e&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And change the “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;e1000e&lt;/code&gt;” to “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vmxnet3&lt;/code&gt;”.&lt;/p&gt;

&lt;p&gt;If you wish, you can also make the VM relecting the actual hardware you have by adding the following line:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;serialNumber.reflectHost = &quot;TRUE&quot;
hw.model.reflectHost = &quot;TRUE&quot;
smbios.reflectHost = &quot;TRUE&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now save the VMX file and close the editor.&lt;/p&gt;

&lt;h2 id=&quot;install-macos-ventura&quot;&gt;Install macOS Ventura&lt;/h2&gt;

&lt;p&gt;By now, you should be able to install it normally just like any previous versions of macOS! Simply boot up the VM we just setup and follow through the setup process.&lt;/p&gt;

&lt;p&gt;Once the installation is done, use the VMware Tools &lt;a href=&quot;https://customerconnect.vmware.com/en/downloads/info/slug/datacenter_cloud_infrastructure/vmware_tools/12_x&quot;&gt;here&lt;/a&gt; instead of the built-in one so you can &lt;a href=&quot;https://kb.vmware.com/s/article/81657&quot;&gt;dynamically adjust the screen resolutions&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/8187bc26-3fab-4947-be03-2fac6c048001_002.jpg&quot; alt=&quot;macOS Ventura&quot; /&gt;&lt;/p&gt;

&lt;p&gt;You should now have a fully working VM os macOS Ventura.&lt;/p&gt;
</description>
                <pubDate>Wed, 08 Jun 2022 14:54:24 +0800</pubDate>
                <link>https://one.vg/blog/install-macos-ventura-beta-in-vmware-fusion</link>
                <guid isPermaLink="true">https://one.vg/blog/install-macos-ventura-beta-in-vmware-fusion</guid>
                
                <category>Mac</category>
                
                
            </item>
        
    </channel>
</rss>