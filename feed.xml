<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title></title>
        <description></description>
        <link>https://one.vg/</link>
        <atom:link href="https://one.vg/feed.xml" rel="self" type="application/rss+xml"/>
        <pubDate>Sun, 10 Jul 2022 04:58:27 +0800</pubDate>
        <lastBuildDate>Sun, 10 Jul 2022 04:58:27 +0800</lastBuildDate>
        <generator>Jekyll v4.2.2</generator>
        
            <item>
                <title>在 VMware Fusion 中啟用 HID Passthrough</title>
                <description>&lt;p&gt;最近購買了一副新鍵盤，它在各方面都表現的相當不錯，但只能透過 Windows 環境才能更新韌體。如果嘗試將鍵盤直接透過 USB 連接到 Windows 虛擬機，你將會失望的發現這類的輸入裝置不會顯示在虛擬機的 USB 裝置清單中。&lt;/p&gt;

&lt;p&gt;其背後的原因其實相當合理：因為輸入裝置（HID）如果被直接指派給虛擬機，將可能導致使用者失去對主作業系統的控制權，因此輸入裝置的直通輸入（HID Passthrough）功能預設被停用。VMware 提供了相關的&lt;a href=&quot;https://kb.vmware.com/s/article/1003418&quot;&gt;知識庫文件&lt;/a&gt;來引導使用者如何啟用此功能。不過在經過一些測試後，此文件似乎對於最新版本的 VMware Fusion（12.2.3 以及 Public Tech Preview 21H1）無效，甚至可能反過來導致此功能無法使用。&lt;/p&gt;

&lt;h2 id=&quot;如何啟用輸入裝置直通輸入hid-passthrough&quot;&gt;如何啟用輸入裝置直通輸入（HID Passthrough）&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;完全退出 Fusion。&lt;/li&gt;
  &lt;li&gt;編輯 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/Library/Preferences/VMware Fusion/config&lt;/code&gt;（需管理者權限）。若檔案不存在則建立一個新檔案。&lt;/li&gt;
  &lt;li&gt;在 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;config&lt;/code&gt; 檔案中加入下列內容：
    &lt;div class=&quot;language-config highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;usb&lt;/span&gt;.&lt;span class=&quot;n&quot;&gt;generic&lt;/span&gt;.&lt;span class=&quot;n&quot;&gt;allowHID&lt;/span&gt; = &lt;span class=&quot;s2&quot;&gt;&quot;TRUE&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;usb&lt;/span&gt;.&lt;span class=&quot;n&quot;&gt;generic&lt;/span&gt;.&lt;span class=&quot;n&quot;&gt;allowLastHID&lt;/span&gt; = &lt;span class=&quot;s2&quot;&gt;&quot;TRUE&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;如果你想要一併啟用視訊裝置直通輸出，可以再加入下列內容：&lt;/p&gt;
    &lt;div class=&quot;language-config highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;vusbcamera&lt;/span&gt;.&lt;span class=&quot;n&quot;&gt;passthrough&lt;/span&gt; = &lt;span class=&quot;s2&quot;&gt;&quot;TRUE&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;儲存檔案並重新啟動 Fusion。&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;以上步驟將會對所有此電腦中的虛擬機啟用 USB 輸入裝置的直通輸入功能。如果輸入裝置仍未出現，請檢查對應虛擬機的 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.vmx&lt;/code&gt; 檔案中是否有上述內容並將他們移除。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/3ed4ac9f-a471-4024-a70c-6ebfc40bdb8b_001.png&quot; alt=&quot;截圖&quot; /&gt;
&lt;em&gt;輸入裝置現在可以直接與虛擬機進行連接。&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;請留意，一旦裝置以此方式連接，必須實體與電腦中斷連線方能與該虛擬機解除連線。&lt;/p&gt;
</description>
                <pubDate>Sun, 10 Jul 2022 04:31:32 +0800</pubDate>
                <link>https://one.vg/tw/blog/hid-passthrough-in-vmware-fusion</link>
                <guid isPermaLink="true">https://one.vg/tw/blog/hid-passthrough-in-vmware-fusion</guid>
                
                <category>VMWare</category>
                
                <category>macOS</category>
                
                
                <category>tw</category>
                
            </item>
        
            <item>
                <title>HID Passthrough in VMware Fusion</title>
                <description>&lt;p&gt;I recently bought a keyboard, which is all nice except that it requires a Windows environment to update the firmware. If you try connecting the keyboard directly to a Windows VM in VMware Fusion via USB, you’d be disappointed to find out that they were not even shown in the device list.&lt;/p&gt;

&lt;p&gt;The reason behind it is actually valid: since human interface devices (HID) being assigned directly to the VM could result in losing control to the host OS, thus HID passthrough was disabled by default. VMware does provide a &lt;a href=&quot;https://kb.vmware.com/s/article/1003418&quot;&gt;KB article&lt;/a&gt; to guide you on how to enable it. But after some testing, seems in the latest version of VMware Fusion (12.2.3 and Public Tech Preview 21H1), doing so not only won’t get you the result you want, it will actually prevent it.&lt;/p&gt;

&lt;h2 id=&quot;how-to-enable-hid-passthrough&quot;&gt;How to Enable HID Passthrough&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;Quit Fusion completely.&lt;/li&gt;
  &lt;li&gt;Edit the file &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/Library/Preferences/VMware Fusion/config&lt;/code&gt; (requires admin privileges). Create one if it wasn’t existed already.&lt;/li&gt;
  &lt;li&gt;Add the following lines to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;config&lt;/code&gt; file:
    &lt;div class=&quot;language-config highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;usb&lt;/span&gt;.&lt;span class=&quot;n&quot;&gt;generic&lt;/span&gt;.&lt;span class=&quot;n&quot;&gt;allowHID&lt;/span&gt; = &lt;span class=&quot;s2&quot;&gt;&quot;TRUE&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;usb&lt;/span&gt;.&lt;span class=&quot;n&quot;&gt;generic&lt;/span&gt;.&lt;span class=&quot;n&quot;&gt;allowLastHID&lt;/span&gt; = &lt;span class=&quot;s2&quot;&gt;&quot;TRUE&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;If you wish to passthrough USB cameras, you can also add the following line:&lt;/p&gt;
    &lt;div class=&quot;language-config highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;vusbcamera&lt;/span&gt;.&lt;span class=&quot;n&quot;&gt;passthrough&lt;/span&gt; = &lt;span class=&quot;s2&quot;&gt;&quot;TRUE&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Save the file and relaunch Fusion.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;This will essentially enable USB HID passthrough for all your VM. If the HID devices still are not there, check the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.vmx&lt;/code&gt; file if the above lines were there and remove them.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/3ed4ac9f-a471-4024-a70c-6ebfc40bdb8b_001.png&quot; alt=&quot;Screenshot&quot; /&gt;
&lt;em&gt;HID devices can now be connect to VM directly.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Note that once you did, you will have to disconnect them physically in order to disconnect them from the VM.&lt;/p&gt;
</description>
                <pubDate>Sun, 10 Jul 2022 04:31:32 +0800</pubDate>
                <link>https://one.vg/blog/hid-passthrough-in-vmware-fusion</link>
                <guid isPermaLink="true">https://one.vg/blog/hid-passthrough-in-vmware-fusion</guid>
                
                <category>VMWare</category>
                
                <category>macOS</category>
                
                
            </item>
        
            <item>
                <title>GitHub Pages 的多語言 404 頁面</title>
                <description>&lt;p&gt;許多具備程式語言能力的人（包含我自己）偏好靜態網站：它們相對快速、更加安全且幾乎可以被託管於任何地方（甚至免費）。雖然靜態網站仍有許多缺點（例如：缺乏互動性），但大多數可以透過第三方服務來達成與動態網站相近的功能。總體而言它仍是多數個人網站的不錯選擇。&lt;/p&gt;

&lt;h2 id=&quot;github-pages&quot;&gt;GitHub Pages&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://pages.github.com/&quot;&gt;GitHub Pages&lt;/a&gt; 是目前最受歡迎的靜態網站託管平台之一：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;它的服務是免費的。&lt;/li&gt;
  &lt;li&gt;它原生支援部落格軟體 &lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt;。&lt;/li&gt;
  &lt;li&gt;它支援&lt;a href=&quot;https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/about-custom-domains-and-github-pages&quot;&gt;自訂網域&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;它可透過 &lt;a href=&quot;https://letsencrypt.org/&quot;&gt;Let’s Encrypt&lt;/a&gt; 支援 &lt;a href=&quot;https://docs.github.com/en/pages/getting-started-with-github-pages/securing-your-github-pages-site-with-https&quot;&gt;HTTPS&lt;/a&gt;。&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;多年來我使用此服務且認為它相當優秀。只是接著便是「雖然…可是…」的部分了。&lt;/p&gt;

&lt;h2 id=&quot;多語言-404-頁面&quot;&gt;多語言 404 頁面&lt;/h2&gt;

&lt;p&gt;雖然 GitHub &lt;a href=&quot;https://docs.github.com/en/pages/getting-started-with-github-pages/creating-a-custom-404-page-for-your-github-pages-site&quot;&gt;允許&lt;/a&gt;在人們嘗試存取網站不存在的頁面時顯示客製化的 404 錯誤頁面且對多數人而言它沒有什麼大問題，但如果打算將你的網站多國語言化便會是個問題：因為它只允許單一版本的錯誤頁面。舉例來說，當檢視此部落格的中文版本時，如果你不知何故點選了一個應為中文頁面的不存在網址，像是：「&lt;a href=&quot;https://one.vg/tw/nonexistent&quot;&gt;https://one.vg/tw/nonexistent&lt;/a&gt;」將會被 GitHub 導向英文版的「&lt;a href=&quot;https://one.vg/404.html&quot;&gt;https://one.vg/404.html&lt;/a&gt;」。此行為可能會導致不黯英文的使用者混亂且無法由此繼續。&lt;/p&gt;

&lt;p&gt;其中一個解決方式為利用 JavaScript 基於網誌路徑來顯示對應的語系字串。然而，這種做法可能使經常變動佈局（layout）或動態網址生成的網站難以維護。我的做法是建立一個 404 頁面範本來讓各語系能擁有自己的對應頁面：&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
├── _data/
│   └── settings.yml &lt;span class=&quot;c&quot;&gt;# 定義語系清單&lt;/span&gt;
├── _includes/
│   └── 404.html     &lt;span class=&quot;c&quot;&gt;# 頁面範本&lt;/span&gt;
├── tw/
│   └── _pages/
│       └── 404.html &lt;span class=&quot;c&quot;&gt;# 中文（台灣）&lt;/span&gt;
└── 404.html         &lt;span class=&quot;c&quot;&gt;# 英文&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;當使用者抵達英文版的頁面時，他們將會被轉而導向對應的語言版本頁面（如本站的情況）。如此我們可以保持更清楚的網站程式碼架構且更易於依照各語言的需求客製化對應頁面。&lt;/p&gt;

&lt;p&gt;範本的部分，可以直接使用原先的 404 頁面並移除前綴的 Front Matter 區域；位於根目錄下的 404 頁面，我們可以將其修改為類似下面的狀態：&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;---
layout: default
title: &apos;Page Not Found&apos;
permalink: /404.html
---
{% include 404.html %}

&lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;onload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;locale&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pathname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;locale_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;locale&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;locale_list&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}};&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;locale_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;includes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;locale&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;redirect&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;encodeURI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pathname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;href&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;origin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;locale&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/404.html?redirect=&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;redirect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;以上這段語法會讀取定義於 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_data/settings.yml&lt;/code&gt; 內的 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;locale_list&lt;/code&gt; 陣列，作為路徑導向判斷的允許清單：&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;locale_list&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;en&quot;,&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;tw&quot;]&apos;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;接著它會檢查網址路徑，嘗試判斷對應的語系並進行重新導向，同時將目前的路徑作為請求參數一併傳送，以便重新導向後可以將網址列恢復為原先用戶輸入的內容。請留意我們只使用路徑部分而非整個 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;href&lt;/code&gt; 值，以避免&lt;a href=&quot;https://cwe.mitre.org/data/definitions/601.html&quot;&gt;開放式重導向&lt;/a&gt;漏洞。&lt;/p&gt;

&lt;p&gt;其他語系的頁面，我們可以採用類似下方的做法：&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;---
layout: default
title: &apos;找不到網頁&apos;
permalink: /tw/404.html
locale: tw
---
{% include 404.html %}

&lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;onload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;search&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;queryString&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;urlParams&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;URLSearchParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;queryString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;redirect&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;decodeURI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;urlParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;redirect&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
      &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pushState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;{{ site.url }}&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;redirect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;此頁面會顯示必要的內容並在不重新載入頁面的情況下還原網址列內容。你可以透過下面的連結來檢視相關效果：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://one.vg/nonexistent&quot;&gt;https://one.vg/nonexistent&lt;/a&gt;（英文）&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://one.vg/tw/nonexistent&quot;&gt;https://one.vg/tw/nonexistent&lt;/a&gt;（中文）&lt;/li&gt;
&lt;/ul&gt;
</description>
                <pubDate>Mon, 27 Jun 2022 15:09:03 +0800</pubDate>
                <link>https://one.vg/tw/blog/multilingual-404-page-for-github-pages</link>
                <guid isPermaLink="true">https://one.vg/tw/blog/multilingual-404-page-for-github-pages</guid>
                
                <category>Coding</category>
                
                <category>Jekyll</category>
                
                
                <category>tw</category>
                
            </item>
        
            <item>
                <title>Multilingual 404 Page for GitHub Pages</title>
                <description>&lt;p&gt;Many of those who can code (myself included) prefer static websites: they are relatively fast, more secure and can be hosted almost anywhere (even for free). Although there are disadvantages of static websites such as lack of interactiveness, most of them can be overcame with 3rd-party services to have features similar to dynamic websites. Overall it’s still a better deal for most personal websites.&lt;/p&gt;

&lt;h2 id=&quot;github-pages&quot;&gt;GitHub Pages&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://pages.github.com/&quot;&gt;GitHub Pages&lt;/a&gt; is currently one of the most popular free platform for hosting static websites:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;It’s free.&lt;/li&gt;
  &lt;li&gt;It supports &lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt; blog-aware natively.&lt;/li&gt;
  &lt;li&gt;It supports &lt;a href=&quot;https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/about-custom-domains-and-github-pages&quot;&gt;custom domains&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;It support &lt;a href=&quot;https://docs.github.com/en/pages/getting-started-with-github-pages/securing-your-github-pages-site-with-https&quot;&gt;HTTPS&lt;/a&gt; via &lt;a href=&quot;https://letsencrypt.org/&quot;&gt;Let’s Encrypt&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I’ve been using it for years and it’s terrific. Then there’s the “but” part.&lt;/p&gt;

&lt;h2 id=&quot;multilingual-404-page&quot;&gt;Multilingual 404 Page&lt;/h2&gt;

&lt;p&gt;Although GitHub &lt;a href=&quot;https://docs.github.com/en/pages/getting-started-with-github-pages/creating-a-custom-404-page-for-your-github-pages-site&quot;&gt;does allow you&lt;/a&gt; to display a custom 404 error page when people try to access nonexistent pages on your site and it works fine for most people, it would become a problem if you are trying to make you website multilingual as it only allows a single version of it. For example, when viewing this blog in Chinese, if somehow you clicked on a nonexistent URL path that should’ve been in Chinese localization, e.g. “&lt;a href=&quot;https://one.vg/tw/nonexistent&quot;&gt;https://one.vg/tw/nonexistent&lt;/a&gt;” will be redirect to “&lt;a href=&quot;https://one.vg/404.html&quot;&gt;https://one.vg/404.html&lt;/a&gt;” by GitHub, which is in English. This behavior could be confusing as the users might not be familiar with English and unable to continue from there.&lt;/p&gt;

&lt;p&gt;One way of solving this is using JavaScript to display the designated localization strings based on the pathname of the URL. However, this would be difficult to maintain especially if you change your website layouts frequently or have dynamic URL generation mechanism. My approach is creating a template of 404 page so each localization can have its own version of the page:&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
├── _data/
│   └── settings.yml &lt;span class=&quot;c&quot;&gt;# Defined localization List&lt;/span&gt;
├── _includes/
│   └── 404.html     &lt;span class=&quot;c&quot;&gt;# Template&lt;/span&gt;
├── tw/
│   └── _pages/
│       └── 404.html &lt;span class=&quot;c&quot;&gt;# Chinese (Taiwan)&lt;/span&gt;
└── 404.html         &lt;span class=&quot;c&quot;&gt;# English&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Once the users landed on the English version of it, they will be redirected to the corresponding localized page (as seen on this website). By doing so, we can have a more clearer structure of the website source code and easier to customized the page to each localization’s need.&lt;/p&gt;

&lt;p&gt;For the template, simply use your original 404 page and remove the front matter section. For the 404 page in the root folder, we can make it something like below:&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;---
layout: default
title: &apos;Page Not Found&apos;
permalink: /404.html
---
{% include 404.html %}

&lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;onload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;locale&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pathname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;locale_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;locale&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;locale_list&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}};&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;locale_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;includes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;locale&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;redirect&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;encodeURI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pathname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;href&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;origin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;locale&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/404.html?redirect=&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;redirect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The script will have the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;locale_list&lt;/code&gt; defined in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_data/settings.yml&lt;/code&gt;, which serves as an allow-list for path redirecting:&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;locale_list&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;[&quot;en&quot;,&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;tw&quot;]&apos;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It will then check the URL pathname and try to determine the corresponding localization, then redirect to it with the current path as query string so we can restore the user-entered one once redirected. Note that we only took the pathname instead of the whole &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;href&lt;/code&gt; value to prevent &lt;a href=&quot;https://cwe.mitre.org/data/definitions/601.html&quot;&gt;open redirect&lt;/a&gt; vulnerability.&lt;/p&gt;

&lt;p&gt;For localized pages, we can do something like below:&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;---
layout: default
title: &apos;找不到網頁&apos;
permalink: /tw/404.html
locale: tw
---
{% include 404.html %}

&lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;onload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;search&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;queryString&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;urlParams&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;URLSearchParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;queryString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;redirect&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;decodeURI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;urlParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;redirect&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
      &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pushState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;{{ site.url }}&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;redirect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The page will display the necessary contents and change the URL of the browser back to its origin with the query value without reloading the page. You can check out the results with the following links:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://one.vg/nonexistent&quot;&gt;https://one.vg/nonexistent&lt;/a&gt; (English)&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://one.vg/tw/nonexistent&quot;&gt;https://one.vg/tw/nonexistent&lt;/a&gt; (Chinese)&lt;/li&gt;
&lt;/ul&gt;
</description>
                <pubDate>Mon, 27 Jun 2022 15:09:03 +0800</pubDate>
                <link>https://one.vg/blog/multilingual-404-page-for-github-pages</link>
                <guid isPermaLink="true">https://one.vg/blog/multilingual-404-page-for-github-pages</guid>
                
                <category>Coding</category>
                
                <category>Jekyll</category>
                
                
            </item>
        
            <item>
                <title>Dior by Birkenstock：Tokio 涼鞋心得</title>
                <description>&lt;blockquote&gt;
  &lt;p&gt;人無法過度關心鞋子的選擇。太多的女性認為它們無關緊要，然而一位優雅女性的證明正是她腳上的穿搭。&lt;/p&gt;

  &lt;p&gt;&lt;cite&gt;Christian Dior&lt;/cite&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Dior 連袂 Birkenstock（勃肯）的&lt;a href=&quot;https://www.birkenstock.com/us/1774/dior/&quot;&gt;聯名系列&lt;/a&gt; 現在正式發表。此系列作為 Dior 今天男性秋冬系列的一部分首次於一月的巴黎時裝周亮相。&lt;/p&gt;

&lt;p&gt;正式發售的版本包含 Tokio 及 Milano 兩種鞋款，以磨砂小牛皮搭配三種配色，分別為：灰色（此配色之鞋面採用羊毛氈）、黑色以及坯布色（然而實際包裝上的標籤為米色）。另有一種較罕見的刺繡款 Tokio 涼鞋，以致敬 1957 年 Dior 高級訂製服系列。&lt;/p&gt;

&lt;p&gt;
  &lt;video muted=&quot;&quot; loop=&quot;&quot; preload=&quot;auto&quot; controls=&quot;&quot; type=&quot;video/mp4&quot; width=&quot;100%&quot; poster=&quot;/images/2b5fad04-c2fe-410d-8750-556b18899ad8_001.jpg&quot;&gt;
    &lt;source src=&quot;/images/2b5fad04-c2fe-410d-8750-556b18899ad8_001.mp4&quot; /&gt;
  &lt;/video&gt;
  &lt;em&gt;Dior by Birkenstock 聯名系列。&lt;/em&gt;
&lt;/p&gt;

&lt;p&gt;我最後選擇了鍾愛的坯布色 Tokio 涼鞋款式，更容易與我多數的服裝做搭配。&lt;/p&gt;

&lt;h2 id=&quot;包裝與細節&quot;&gt;包裝與細節&lt;/h2&gt;

&lt;p&gt;與 Louis Vuitton 和 Nike 聯名的「Air Force 1」以及「Air Dior」類似，Dior by Birkenstock 聯名系列亦採用了特殊的包裝，採用與 EVA 鞋底相同的 Dior 老花以及 Birkenstock「骨」構成的漸變主題的壓印外盒：&lt;/p&gt;

&lt;div class=&quot;gallery-box&quot;&gt;
  &lt;div class=&quot;gallery&quot;&gt;
    &lt;img src=&quot;/images/2b5fad04-c2fe-410d-8750-556b18899ad8_002.jpg&quot; /&gt;
    &lt;img src=&quot;/images/2b5fad04-c2fe-410d-8750-556b18899ad8_003.jpg&quot; /&gt;
  &lt;/div&gt;
  &lt;em&gt;Dior 老花以及 Birkenstock「骨」構成的漸變主題。&lt;/em&gt;
&lt;/div&gt;

&lt;p&gt;雖然此鞋款相較於普通的勃肯鞋讓人感到更佳精緻，因款式較為特殊，一旦鞋底磨損後可能無法如其他勃肯鞋一般透過 Dior 或者 Birkenstock 官方維修恢復為出廠時的鞋底圖樣。包裝紙亦採用了與外包裝相同的圖案而非一般 Dior 鞋履所使用的白色 Dior 字樣包裝紙。防塵袋為白色（Dior 男士系列較常使用海軍藍色的防塵袋，而 Dior 女士系列則較常使用白色防塵袋），底部綴有「Birkenstock」的標誌。&lt;/p&gt;

&lt;div class=&quot;gallery-box&quot;&gt;
  &lt;div class=&quot;gallery&quot;&gt;
    &lt;img src=&quot;/images/2b5fad04-c2fe-410d-8750-556b18899ad8_004.jpg&quot; /&gt;
    &lt;img src=&quot;/images/2b5fad04-c2fe-410d-8750-556b18899ad8_005.jpg&quot; /&gt;
  &lt;/div&gt;
  &lt;em&gt;與外包裝相同的圖案的包裝紙以及白色防塵袋。&lt;/em&gt;
&lt;/div&gt;

&lt;p&gt;包裝包含一張使用相同主題的浮雕印刷卡片，以法文以及英文介紹本次的聯名系列。聯名版本的勃肯鞋於磨砂小牛皮後踝帶內側壓印了尺寸以及「Limited Edition」（限定版）字樣。通常版本的勃肯鞋履尺寸號碼一般位於人體工學鞋底面上。Tokio 款式於鞋頭部分多了橡膠加固，使得它比起一般勃肯鞋更加防水、耐用。Dior 經典鋁質扣環也令聯名版本更容易穿脫，更可以減少小牛皮的損傷。&lt;/p&gt;

&lt;p&gt;有趣的是，Dior 選擇由 Birkenstock 的德國工廠生產此次的聯名系列，而非自家的義大利工坊。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2b5fad04-c2fe-410d-8750-556b18899ad8_006.jpg&quot; alt=&quot;簡介卡&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;gallery-box&quot;&gt;
  &lt;div class=&quot;gallery&quot;&gt;
    &lt;img src=&quot;/images/2b5fad04-c2fe-410d-8750-556b18899ad8_007.jpg&quot; /&gt;
    &lt;img src=&quot;/images/2b5fad04-c2fe-410d-8750-556b18899ad8_008.jpg&quot; /&gt;
  &lt;/div&gt;
  &lt;em&gt;簡介卡以及熱壓印。&lt;/em&gt;
&lt;/div&gt;

&lt;p&gt;當然，這些奢華細節勢必有相對的代價：正確來說是新台幣 35,000 元 —— 大約是任一雙勃肯鞋的十倍。&lt;/p&gt;

&lt;h2 id=&quot;惡名昭彰的適應期&quot;&gt;惡名昭彰的「適應期」&lt;/h2&gt;

&lt;p&gt;即便看起來如此優越，它仍舊有我個人難以喜愛的面向。&lt;/p&gt;

&lt;p&gt;不知基於何種原因，Dior 選擇使用 Birkenstock 惡名昭彰的經典硬式鞋底。它需要穿著者在感受到客製鞋一般的舒適之前忍受漫長且疼痛的適應期。這幾年 Birkenstock 已經針對旗下的涼鞋預設提供軟底的款式，因大眾已不再相信鞋履所帶來的舒適感值得承受「一分耕耘，一分收穫」式的痛苦過程。&lt;/p&gt;

&lt;p&gt;如果你打算購入此鞋款，請先做好得穿幾週超厚底襪和忍受足弓疼痛的心理準備。使用錘子輕輕敲打受壓處可能有助於減緩過渡期的不適感，但拿工具敲打定價將近四萬元的鞋履對多數人來說勢必會造成一些心理壓力。如果你想要一開始就能舒適的穿鞋，建議省點錢去購買非 Dior 聯名的軟底勃肯鞋。Christian Louboutin 曾表示：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;鞋履轉化人的肢體語言和態度。它們在生理與心靈層面提升一個人。&lt;/p&gt;

  &lt;p&gt;&lt;cite&gt;Christian Louboutin&lt;/cite&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;我完全同意大師的說法⋯⋯除了這次以外。&lt;/p&gt;
</description>
                <pubDate>Sat, 18 Jun 2022 19:46:59 +0800</pubDate>
                <link>https://one.vg/tw/blog/dior-by-birkenstock-tokio-mules-review</link>
                <guid isPermaLink="true">https://one.vg/tw/blog/dior-by-birkenstock-tokio-mules-review</guid>
                
                <category>Fashion</category>
                
                <category>Dior</category>
                
                
                <category>tw</category>
                
            </item>
        
            <item>
                <title>Dior by Birkenstock: Tokio Mules Review</title>
                <description>&lt;blockquote&gt;
  &lt;p&gt;You can never take too much care over the choice of your shoes. Too many women think that they are unimportant, but the real proof of an elegant woman is what is on her feet.&lt;/p&gt;

  &lt;p&gt;&lt;cite&gt;Christian Dior&lt;/cite&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Dior’s Birkenstock &lt;a href=&quot;https://www.birkenstock.com/us/1774/dior/&quot;&gt;collaboration&lt;/a&gt; is now available, featuring two of Birkenstock’s signature styles: the Tokio Mule and Milano Sandal. It was first revealed during Paris Fashion Week back in January as part of Dior Men’s fall/winter collection.&lt;/p&gt;

&lt;p&gt;The retail version features three different color options in nubuck calfskin for both Tokio and Milano: gray (this option also features a felted wool upper body instead of nubuck calfskin one), black and greige (tho on the box it said beige). There’s also a rare variant of grey Tokio Mules with pattens represent the 1957 Dior haute couture collection.&lt;/p&gt;

&lt;p&gt;
  &lt;video muted=&quot;&quot; loop=&quot;&quot; preload=&quot;auto&quot; controls=&quot;&quot; type=&quot;video/mp4&quot; width=&quot;100%&quot; poster=&quot;/images/2b5fad04-c2fe-410d-8750-556b18899ad8_001.jpg&quot;&gt;
    &lt;source src=&quot;/images/2b5fad04-c2fe-410d-8750-556b18899ad8_001.mp4&quot; /&gt;
  &lt;/video&gt;
  &lt;em&gt;Dior by Birkenstock collections.&lt;/em&gt;
&lt;/p&gt;

&lt;p&gt;I end up picked up a pair of Tokio as it’s my favorite style, and in beige as it works best with most of my outfits.&lt;/p&gt;

&lt;h2 id=&quot;packaging-and-details&quot;&gt;Packaging and Details&lt;/h2&gt;

&lt;p&gt;Like the Louis Vuitton and Nike “Air Force 1” and the “Air Dior”, the Dior by Birkenstock collaboration also features a special packaging with Dior Oblique and Bones gradient motif that matches its EVA outsole:&lt;/p&gt;

&lt;div class=&quot;gallery-box&quot;&gt;
  &lt;div class=&quot;gallery&quot;&gt;
    &lt;img src=&quot;/images/2b5fad04-c2fe-410d-8750-556b18899ad8_002.jpg&quot; /&gt;
    &lt;img src=&quot;/images/2b5fad04-c2fe-410d-8750-556b18899ad8_003.jpg&quot; /&gt;
  &lt;/div&gt;
  &lt;em&gt;Dior Oblique and Birkenstock Bones gradient motif.&lt;/em&gt;
&lt;/div&gt;

&lt;p&gt;Although it looks nice and feel more premium than any ordinary birks, I doubt the outsole can be restored to its original oblique pattern once wear out, neither by Dior or Birkenstock. The wrapping paper were also in such pattern unlike other Dior shoes. The dust bags were in white (Dior Men tend to use navy blue dust bags, while Dior Women tend to have white dust bags), with “Birkenstock” logo at the bottom.&lt;/p&gt;

&lt;div class=&quot;gallery-box&quot;&gt;
  &lt;div class=&quot;gallery&quot;&gt;
    &lt;img src=&quot;/images/2b5fad04-c2fe-410d-8750-556b18899ad8_004.jpg&quot; /&gt;
    &lt;img src=&quot;/images/2b5fad04-c2fe-410d-8750-556b18899ad8_005.jpg&quot; /&gt;
  &lt;/div&gt;
  &lt;em&gt;The oblique wrapping paper and dust bags.&lt;/em&gt;
&lt;/div&gt;

&lt;p&gt;There’s a small card which embossed pattern just like the outer box, as an introduction to the Dior and Birkenstock collaboration. The birks were hot stamped with size number and “limited edition” label in silver on the back strap. Ordinary birks usually have their size numbers on the footbed. The toe section of the Tokio were reinforced with rubber, make then more water resistance and durable than usual birks. The Dior signature aluminum buckle make it easier to open while also prevent bending of the calfskin.&lt;/p&gt;

&lt;p&gt;Interestingly, Dior has Birkenstock manufactures these birks in Germany instead of making them in-house in Italy.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2b5fad04-c2fe-410d-8750-556b18899ad8_006.jpg&quot; alt=&quot;The Introduction&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;gallery-box&quot;&gt;
  &lt;div class=&quot;gallery&quot;&gt;
    &lt;img src=&quot;/images/2b5fad04-c2fe-410d-8750-556b18899ad8_007.jpg&quot; /&gt;
    &lt;img src=&quot;/images/2b5fad04-c2fe-410d-8750-556b18899ad8_008.jpg&quot; /&gt;
  &lt;/div&gt;
  &lt;em&gt;Introduction card and hot stamping.&lt;/em&gt;
&lt;/div&gt;

&lt;p&gt;And of course, all those premium touches came with a price: €960 to be exact - that’s about ten fold of any off-the-shelf birks.&lt;/p&gt;

&lt;h2 id=&quot;the-infamous-break-in-process&quot;&gt;The Infamous “Break-In” Process&lt;/h2&gt;

&lt;p&gt;As superior as it seems, there’s actually something I personally didn’t like.&lt;/p&gt;

&lt;p&gt;For some reason, Dior chose Birkenstock’s infamous classic footbed, which requires the wearer to endure the painful break-in process before it can be comfortable. Birkenstock these days offers soft footbed by default for most of their sandals, as the majority no longer believes the pain is actually worth the outcome.&lt;/p&gt;

&lt;p&gt;Prepare to wear some extra thick socks and bearing the foot arch pain for a few weeks if you are getting a pair of these. Some hammer work might help with the process, but hammering a €1k shoes would definitely give most people some pressure. But if you want something comfy from the start, save yourself a few bucks and get a non-Dior birks instead. As Christian Louboutin once said,&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Shoes transform your body language and attitude. They lift you physically and emotionally.&lt;/p&gt;

  &lt;p&gt;&lt;cite&gt;Christian Louboutin&lt;/cite&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Well, I can’t agree more with him…just not this time.&lt;/p&gt;
</description>
                <pubDate>Sat, 18 Jun 2022 19:46:59 +0800</pubDate>
                <link>https://one.vg/blog/dior-by-birkenstock-tokio-mules-review</link>
                <guid isPermaLink="true">https://one.vg/blog/dior-by-birkenstock-tokio-mules-review</guid>
                
                <category>Fashion</category>
                
                <category>Dior</category>
                
                
            </item>
        
            <item>
                <title>透過 Quartz 濾鏡減少 PDF 檔案大小</title>
                <description>&lt;p&gt;macOS 內建 Quartz 濾鏡「減少檔案大小」，可透過重新壓縮圖形來減少檔案的大小。對於需要降低高品質的 PDF 檔案來發送電子郵件附件或上傳至有檔案大小限制的網站時它相當的方便相當的方便。&lt;/p&gt;

&lt;p&gt;不過這個濾鏡有個小問題：預設它會將圖片解析度縮小至一半，且有著 512 像素的長寬上限。這將使得壓縮後的圖片內容過於模糊而難以閱讀。幸運的是，我們有方法可以客製化濾鏡壓縮參數以符合特定的需求。&lt;/p&gt;

&lt;h2 id=&quot;透過色彩同步工具程式修改-quartz-濾鏡&quot;&gt;透過「色彩同步工具程式」修改 Quartz 濾鏡&lt;/h2&gt;

&lt;p&gt;「色彩同步工具程式」位於「應用程式 &amp;gt; 工具程式」中（也可以透過 Spotlight 開啟）：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/200e4c26-c102-432f-9c4d-626274db5702_001.jpg&quot; alt=&quot;色彩同步工具程式路徑&quot; /&gt;&lt;/p&gt;

&lt;p&gt;首先，點擊「複製」按鈕來建立一個可編輯的「減少檔案大小」濾鏡副本：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/200e4c26-c102-432f-9c4d-626274db5702_002.jpg&quot; alt=&quot;複製濾鏡&quot; /&gt;&lt;/p&gt;

&lt;p&gt;接著重新命名以及修改新建立的濾鏡來調整目標影像品質：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/200e4c26-c102-432f-9c4d-626274db5702_003.jpg&quot; alt=&quot;編輯濾鏡&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;直接修改-quartz-濾鏡檔案&quot;&gt;直接修改 Quartz 濾鏡檔案&lt;/h2&gt;

&lt;p&gt;雖然圖形介面可以調整影像的壓縮率，但因為滑桿未顯示百分比數值導致我們無法精確的調整畫質參數。想直接編輯參數，開啟 Finder，找到位於「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~/Library/Filters&lt;/code&gt;」（簡單的方法為在 Finder 選單「前往 &amp;gt; 移至資料夾…」中貼上該路徑）的濾鏡檔案：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/200e4c26-c102-432f-9c4d-626274db5702_004.jpg&quot; alt=&quot;找出濾鏡位置&quot; /&gt;&lt;/p&gt;

&lt;p&gt;透過文字編輯器開啟與剛才建立的濾鏡名稱相符的「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.qfilter&lt;/code&gt;」檔案：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/200e4c26-c102-432f-9c4d-626274db5702_005.jpg&quot; alt=&quot;編輯濾鏡&quot; /&gt;&lt;/p&gt;

&lt;p&gt;即可指定相關的數值。其中「Compression Quality」介於 0.0 和 1.0 之間，數值越高品質越佳。&lt;/p&gt;

&lt;h2 id=&quot;套用-quartz-濾鏡&quot;&gt;套用 Quartz 濾鏡&lt;/h2&gt;

&lt;p&gt;建立好的濾鏡可以透過預覽程式於儲存或匯出 PDF 檔案時套用：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/200e4c26-c102-432f-9c4d-626274db5702_006.jpg&quot; alt=&quot;套用濾鏡&quot; /&gt;&lt;/p&gt;

&lt;p&gt;測試相關的參數以找出最符合使用情境的組合。你也可以建立多個客製化的濾鏡。&lt;/p&gt;
</description>
                <pubDate>Sun, 12 Jun 2022 14:39:14 +0800</pubDate>
                <link>https://one.vg/tw/blog/reduce-pdf-size-with-quartz-filter</link>
                <guid isPermaLink="true">https://one.vg/tw/blog/reduce-pdf-size-with-quartz-filter</guid>
                
                <category>Mac</category>
                
                <category>macOS</category>
                
                
                <category>tw</category>
                
            </item>
        
            <item>
                <title>Reduce PDF Size with Quartz Filter</title>
                <description>&lt;p&gt;macOS has a built-in Quartz filter named “Reduce File Size”, which can be used to reducing the size of the file by recompressing graphics. It’s useful when you need to reduce the size of a high quality PDF for emailing or uploading to a website that has file size limitations.&lt;/p&gt;

&lt;p&gt;But there’s a small issue: by default, this filter scales the image resolution by 50% and has a maximum width or height of 512 pixels, render most of the images way too blur to be readable. Fortunately, there’s a way to customize it to your needs.&lt;/p&gt;

&lt;h2 id=&quot;modify-quartz-filters-in-colorsync-utility&quot;&gt;Modify Quartz filters in ColorSync Utility&lt;/h2&gt;

&lt;p&gt;ColorSync Utility can be found in “Applications &amp;gt; Utilities” (or simply use Spotlight):&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/200e4c26-c102-432f-9c4d-626274db5702_001.jpg&quot; alt=&quot;ColorSync Utility Path&quot; /&gt;&lt;/p&gt;

&lt;p&gt;First, duplicate the existing “Reduce File Size” filter by clicking the duplicate button so we can have a modifiable copy:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/200e4c26-c102-432f-9c4d-626274db5702_002.jpg&quot; alt=&quot;Duplicate Filter&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Then rename and modify the newly created filter to adjust the target image quality:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/200e4c26-c102-432f-9c4d-626274db5702_003.jpg&quot; alt=&quot;Edit Filter&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;modify-quartz-filters-directly&quot;&gt;Modify Quartz Filters Directly&lt;/h2&gt;

&lt;p&gt;Although the image compression is adjustable, we are unable to specify the quality factor/recompressing ratio as it’s set by a slider without percentage value. To edit the values directly, open Finder, locate the filter file at “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~/Library/Filters&lt;/code&gt;” (an easier way is via “Finder &amp;gt; Go &amp;gt; Go to Folder…” and paste the path):&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/200e4c26-c102-432f-9c4d-626274db5702_004.jpg&quot; alt=&quot;Locate Filter&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Open the “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.qfilter&lt;/code&gt;” file with text editor that matched the one you created:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/200e4c26-c102-432f-9c4d-626274db5702_005.jpg&quot; alt=&quot;Edit Filter&quot; /&gt;&lt;/p&gt;

&lt;p&gt;You can then specify the values. The “Compression Quality” is between 0.0 and 1.0, higher means better quality.&lt;/p&gt;

&lt;h2 id=&quot;apply-quartz-filters&quot;&gt;Apply Quartz Filters&lt;/h2&gt;

&lt;p&gt;The created filter is accessible in Preview app when saving or exporting:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/200e4c26-c102-432f-9c4d-626274db5702_006.jpg&quot; alt=&quot;Apply Filter&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Test the values to find what works best for you. You can also have multiple customized filter.&lt;/p&gt;
</description>
                <pubDate>Sun, 12 Jun 2022 14:39:14 +0800</pubDate>
                <link>https://one.vg/blog/reduce-pdf-size-with-quartz-filter</link>
                <guid isPermaLink="true">https://one.vg/blog/reduce-pdf-size-with-quartz-filter</guid>
                
                <category>Mac</category>
                
                <category>macOS</category>
                
                
            </item>
        
            <item>
                <title>在 Apple Silicon Mac 上運行 macOS Ventura 預覽版虛擬機</title>
                <description>&lt;p&gt;從 macOS 12「Monterey」開始，Apple 設計了 &lt;em&gt;&lt;a href=&quot;https://developer.apple.com/documentation/virtualization&quot;&gt;Virtualization 虛擬化框架&lt;/a&gt;&lt;/em&gt;，提供高階 APIs 用以於 Apple Silicon 和 Intel 架構的 Mac 電腦上建立和管理虛擬機。對 Intel 架構的 Mac 而言並沒有實際使用的必要，因為第三方商用虛擬機器監視器（Hypervisor）更加先進且具備更多功能；然而不幸的是，對於 Apple Silicon 架構的 Mac 來說，這是至本文撰寫為止唯一的 macOS 虛擬化方案。&lt;/p&gt;

&lt;p&gt;然而，目前的 Virtualization 框架本身相當原始且有諸多限制，包含但不限於下列的項目：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;不支援安裝任何早於 macOS Monterey 的系統版本（因為 Virtualization 框架在其後才推出）。&lt;/li&gt;
  &lt;li&gt;於 macOS Monterey 上嘗試使用 macOS Ventura 的 IPSW（還原映像檔）安裝虛擬機會發生錯誤性崩潰。&lt;/li&gt;
  &lt;li&gt;無法完整客製化虛擬機硬體，僅能映射實體主機。&lt;/li&gt;
  &lt;li&gt;虛擬機內無法登入系統 Apple ID。&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;現在你大概可以理解為何 Apple Silicon 上目前尚無商業化的 macOS 虛擬化解決方案：這些 API 目前在本質上難以實用化。但撇除這些限制，虛擬機運行得相當不錯且相較於 Intel 架構的 Mac 而言速度驚人的快。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/71ac2589-ded9-4fd0-8fdc-6a8fd1d93948_001.jpg&quot; alt=&quot;macOS VM with Virtualization framework&quot; /&gt;
&lt;em&gt;macOS Ventura 虛擬機運行於 Apple Silicon 架構的 MacBook Pro。&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;事前準備&quot;&gt;事前準備&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;一台 Apple Silicon 架構的 Mac 電腦。&lt;/li&gt;
  &lt;li&gt;因為本篇教學建立在 Apple 的範例專案上，你需要具備基礎的程式設計（不論是 Objective-C 亦或是 Swift）能力。&lt;/li&gt;
  &lt;li&gt;一個 Apple ID 帳號作為開發者帳號，用於程式簽章。&lt;/li&gt;
  &lt;li&gt;Xcode 的基本使用知識，以及 Xcode 13 或更新的版本。&lt;/li&gt;
  &lt;li&gt;一份&lt;a href=&quot;https://developer.apple.com/documentation/virtualization/running_macos_in_a_virtual_machine_on_apple_silicon_macs&quot;&gt;官方範例專案&lt;/a&gt;。&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;現在我們可以開始安裝啦！&lt;/p&gt;

&lt;h2 id=&quot;設定虛擬機&quot;&gt;設定虛擬機&lt;/h2&gt;

&lt;p&gt;雖然官方的範例專案本身可以直接執行，你可能會想要先行調整部分設定參數以便更硬體符合需求。之後的文章內容將會以 Swfit 版本的程式碼作為範例，但 Objective-C 版本差異並不大，可自行推敲。&lt;/p&gt;

&lt;h4 id=&quot;安裝路徑&quot;&gt;安裝路徑&lt;/h4&gt;

&lt;p&gt;欲修改預設的安裝路徑，檢視「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Path.swift&lt;/code&gt;」並作適當的修改。預設會將虛擬機安裝至使用者目錄下的「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;VM.bundle&lt;/code&gt;」。&lt;/p&gt;

&lt;h4 id=&quot;處理器核心數&quot;&gt;處理器核心數&lt;/h4&gt;

&lt;p&gt;欲修改分配給虛擬機的處理器核心數，請修改「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MacOSVirtualMachineConfigurationHelper.swift&lt;/code&gt;」中的函式「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;computeCPUCount()&lt;/code&gt;」：&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;computeCPUCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;totalAvailableCPUs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ProcessInfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;processInfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;processorCount&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;virtualCPUCount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;totalAvailableCPUs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;totalAvailableCPUs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;virtualCPUCount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;virtualCPUCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZVirtualMachineConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minimumAllowedCPUCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;virtualCPUCount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;virtualCPUCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZVirtualMachineConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maximumAllowedCPUCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;virtualCPUCount&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;預設程式會使用你所有的核心數減去 1 個核。你也可以用演算的方式搭配 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.maximumAllowedCPUCount&lt;/code&gt; 來動態產生最佳數值。&lt;/p&gt;

&lt;h4 id=&quot;記憶體&quot;&gt;記憶體&lt;/h4&gt;

&lt;p&gt;欲修改分配給虛擬機的記憶體數值，請修改「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MacOSVirtualMachineConfigurationHelper.swift&lt;/code&gt;」中的函式「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;computeMemorySize()&lt;/code&gt;」：&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;computeMemorySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;UInt64&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// We arbitrarily choose 4GB.&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;memorySize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;UInt64&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;memorySize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;memorySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZVirtualMachineConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minimumAllowedMemorySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;memorySize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;memorySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZVirtualMachineConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maximumAllowedMemorySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;memorySize&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;預設程式分配 4GB 的記憶體。你也可以用演算的方式搭配 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.maximumAllowedMemorySize&lt;/code&gt; 來動態產生最佳數值。&lt;/p&gt;

&lt;h4 id=&quot;顯示器解析度以及點距ppi&quot;&gt;顯示器解析度以及點距（PPI）&lt;/h4&gt;

&lt;p&gt;Virtualization 框架目前尚未支援動態解析度調整。欲修改虛擬機的顯示器解析度以及點距，請修改「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MacOSVirtualMachineConfigurationHelper.swift&lt;/code&gt;」中的函式「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;createGraphicsDeviceConfiguration()&lt;/code&gt;」：&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;createGraphicsDeviceConfiguration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZMacGraphicsDeviceConfiguration&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;graphicsConfiguration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZMacGraphicsDeviceConfiguration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;graphicsConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;displays&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// We abitrarily choose the resolution of the display to be 1920 x 1200.&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;VZMacGraphicsDisplayConfiguration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;widthInPixels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1920&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;heightInPixels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;pixelsPerInch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;graphicsConfiguration&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;例如，14 英吋的 MacBook Pro 螢幕點距為 284，請依照你的實際硬體做修改。修改後將啟用高解析度（HiDPI，即 Retina）模式。&lt;/p&gt;

&lt;h4 id=&quot;磁碟大小&quot;&gt;磁碟大小&lt;/h4&gt;

&lt;p&gt;預設的虛擬磁碟大小為 64GB。欲調整分配給虛擬機的磁碟空間，請修改「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MacOSVirtualMachineInstaller.swift&lt;/code&gt;」中的函式「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;createDiskImage()&lt;/code&gt;」：&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;createDiskImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;diskFd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;diskImagePath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;O_RDWR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;O_CREAT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;S_IRUSR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;S_IWUSR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;diskFd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;fatalError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Cannot create disk image.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// 64GB disk space.&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ftruncate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;diskFd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;fatalError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ftruncate() failed.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;diskFd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;fatalError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Failed to close the disk image.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;請至少分配 64GB 的磁碟空間予虛擬機，以確保運行穩定。&lt;/p&gt;

&lt;p&gt;當然，還有其他可以做調整的參數，不過並沒有前面提及的這些重要。&lt;/p&gt;

&lt;h2 id=&quot;安裝-macos-monterey&quot;&gt;安裝 macOS Monterey&lt;/h2&gt;

&lt;p&gt;一旦完成設定，請執行「InstallationTool」來進行初始化。此工具會嘗試取得目前實體 Mac 主機公開發佈的最新 macOS 版本。你也可以修改原始碼來強制使用其他的 IPSW 檔案，不過由於目前僅有 Monterey 可供下載，我們可以不做更動。&lt;/p&gt;

&lt;p&gt;安裝完成後，接著執行「macOSVirtualMachineSampleApp」。程式將於新視窗中啟動剛才安裝好的 macOS 虛擬機。&lt;/p&gt;

&lt;h2 id=&quot;安裝-macos-ventura-預覽版&quot;&gt;安裝 macOS Ventura 預覽版&lt;/h2&gt;

&lt;p&gt;當你可以操作虛擬機時，開啟 Safari 並下載&lt;a href=&quot;/tw/blog/install-macos-ventura-beta-in-vmware-fusion#obtain-the-macos-ventura-installer&quot;&gt;此處&lt;/a&gt;的「&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;InstallAssistant.pkg&lt;/code&gt;」macOS Ventura 安裝程式。目前透過 Apple 開發者網站取得之「macOS Developer Beta Access Utility」會發生錯誤而無法透過系統更新直接升級至 macOS Ventura 預覽版。&lt;/p&gt;

&lt;p&gt;安裝下載完成的 PKG 檔案，接著開啟位於應用程式資料夾中的「Install macOS 13 beta.app」來開始 macOS 安裝。有鑒於 macOS Ventura 大幅度變更了系統偏好設定的介面，這裡建議先在目前的環境下做好所需的系統設定後再進行升級安裝。&lt;/p&gt;

&lt;p&gt;接著等待安裝完成。你現在應該有一台能夠在 Apple Silicon 架構的 Mac 上正常操作的 macOS Ventura 虛擬機。&lt;/p&gt;
</description>
                <pubDate>Thu, 09 Jun 2022 10:43:14 +0800</pubDate>
                <link>https://one.vg/tw/blog/running-macos-ventura-in-a-virtual-machine-on-apple-silicon-macs</link>
                <guid isPermaLink="true">https://one.vg/tw/blog/running-macos-ventura-in-a-virtual-machine-on-apple-silicon-macs</guid>
                
                <category>Mac</category>
                
                <category>Apple Silicon</category>
                
                
                <category>tw</category>
                
            </item>
        
            <item>
                <title>Running macOS Ventura Beta in a Virtual Machine on Apple Silicon Macs</title>
                <description>&lt;p&gt;Since macOS 12 “Monterey”, Apple has created the &lt;em&gt;&lt;a href=&quot;https://developer.apple.com/documentation/virtualization&quot;&gt;Virtualization framework&lt;/a&gt;&lt;/em&gt; which provides high-level APIs for creating and managing virtual machines (VM) on Apple silicon and Intel-based Macs. For Intel-based Macs, there is no necessity for using it, as 3rd-party commercial hypervisors are way more advanced and more feature-rich. Unfortunately for Apple silicon Macs, this seems to be the only way to virtualize macOS at the time of writing.&lt;/p&gt;

&lt;p&gt;However, the current version of Virtualization framework is pretty bare-bone and has many limitations, including but not limited to:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Any macOS version prior to macOS Monterey isn’t supported (as the Virtualization framework was introduced in Monterey).&lt;/li&gt;
  &lt;li&gt;It will crash if you try to use the IPSW (restore image file) of macOS Ventura for installation on a macOS Monterey host.&lt;/li&gt;
  &lt;li&gt;There’s no way to fully customized the virtual hardware but only reflect hardware of the host machine.&lt;/li&gt;
  &lt;li&gt;You can’t sign-in Apple ID in the VM.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Now you might be able to comprehend why there’s no commercial-grade 3rd-party virtualization software for macOS on Apple silicon: the APIs were just too hard to work with at this time. But other than those limitations, it works quite well and is amazingly fast compares to its Intel-based counterpart.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/71ac2589-ded9-4fd0-8fdc-6a8fd1d93948_001.jpg&quot; alt=&quot;macOS VM with Virtualization framework&quot; /&gt;
&lt;em&gt;macOS Ventura VM running on an Apple silicon MacBook Pro.&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;pre-requirements&quot;&gt;Pre-requirements&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;An Apple silicon Mac.&lt;/li&gt;
  &lt;li&gt;As this guide is based on an Apple sample project, basic knowledge of programming (for either Objective-C or Swift) is required.&lt;/li&gt;
  &lt;li&gt;An Apple ID as developer account for code-signing.&lt;/li&gt;
  &lt;li&gt;Basic knowledge of Xcode and have Xcode 13 or later installed.&lt;/li&gt;
  &lt;li&gt;A copy of &lt;a href=&quot;https://developer.apple.com/documentation/virtualization/running_macos_in_a_virtual_machine_on_apple_silicon_macs&quot;&gt;this sample project&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Now we can start the installation!&lt;/p&gt;

&lt;h2 id=&quot;configure-the-virtual-machine&quot;&gt;Configure the Virtual Machine&lt;/h2&gt;

&lt;p&gt;Although the sample project itself works out of the box, you might want to adjust some of the configurations. The rest of the guide will use Swift version as example, but Objective-C version is pretty similar.&lt;/p&gt;

&lt;h4 id=&quot;installation-path&quot;&gt;Installation Path&lt;/h4&gt;

&lt;p&gt;To change the hardcoded installation path, look into “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Path.swift&lt;/code&gt;” and edit the path as you please. By default, it will install into “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;VM.bundle&lt;/code&gt;” in your home folder.&lt;/p&gt;

&lt;h4 id=&quot;cpu-cores&quot;&gt;CPU Cores&lt;/h4&gt;

&lt;p&gt;To change the allocate CPU cores for the VM, look for function “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;computeCPUCount()&lt;/code&gt;” in “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MacOSVirtualMachineConfigurationHelper.swift&lt;/code&gt;”:&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;computeCPUCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;totalAvailableCPUs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ProcessInfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;processInfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;processorCount&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;virtualCPUCount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;totalAvailableCPUs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;totalAvailableCPUs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;virtualCPUCount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;virtualCPUCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZVirtualMachineConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minimumAllowedCPUCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;virtualCPUCount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;virtualCPUCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZVirtualMachineConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maximumAllowedCPUCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;virtualCPUCount&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;By default, it will use your total available cores minus 1. You can also calculate the optimal value dynamically with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.maximumAllowedCPUCount&lt;/code&gt;.&lt;/p&gt;

&lt;h4 id=&quot;memory&quot;&gt;Memory&lt;/h4&gt;

&lt;p&gt;To change the allocate memory for the VM, look for function “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;computeMemorySize()&lt;/code&gt;” in “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MacOSVirtualMachineConfigurationHelper.swift&lt;/code&gt;”:&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;computeMemorySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;UInt64&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// We arbitrarily choose 4GB.&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;memorySize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;UInt64&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;memorySize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;memorySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZVirtualMachineConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minimumAllowedMemorySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;memorySize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;memorySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZVirtualMachineConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maximumAllowedMemorySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;memorySize&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;By default the value is 4GB. Instead of hardcode the memory size, you can also calculate the optimal size dynamically with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.maximumAllowedMemorySize&lt;/code&gt;.&lt;/p&gt;

&lt;h4 id=&quot;display-resolution-and-ppi&quot;&gt;Display Resolution and PPI&lt;/h4&gt;

&lt;p&gt;The Virtualization framework has yet to support dynamic resolutions. To change the display resolution and PPI, look for function “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;createGraphicsDeviceConfiguration()&lt;/code&gt;” in “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MacOSVirtualMachineConfigurationHelper.swift&lt;/code&gt;”:&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;createGraphicsDeviceConfiguration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZMacGraphicsDeviceConfiguration&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;graphicsConfiguration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VZMacGraphicsDeviceConfiguration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;graphicsConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;displays&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// We abitrarily choose the resolution of the display to be 1920 x 1200.&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;VZMacGraphicsDisplayConfiguration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;widthInPixels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1920&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;heightInPixels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;pixelsPerInch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;graphicsConfiguration&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For example, the PPI for 14” MacBook Pro is 284. Change it to enable HiDPI (Retina) mode.&lt;/p&gt;

&lt;h4 id=&quot;disk-size&quot;&gt;Disk Size&lt;/h4&gt;

&lt;p&gt;The default disk size of the VM is 64GB. To change it, look for function “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;createDiskImage()&lt;/code&gt;” in “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MacOSVirtualMachineInstaller.swift&lt;/code&gt;”:&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;createDiskImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;diskFd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;diskImagePath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;O_RDWR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;O_CREAT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;S_IRUSR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;S_IWUSR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;diskFd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;fatalError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Cannot create disk image.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// 64GB disk space.&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ftruncate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;diskFd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;fatalError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ftruncate() failed.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;diskFd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;fatalError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Failed to close the disk image.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You should allocate at least 64GB of the disk space for stability.&lt;/p&gt;

&lt;p&gt;Of course, there are other settings that you can play around, but they were not as important.&lt;/p&gt;

&lt;h2 id=&quot;install-macos-monterey&quot;&gt;Install macOS Monterey&lt;/h2&gt;

&lt;p&gt;Once configured, run the “InstallationTool” will initiate the process. It will try to obtain the latest copy that’s public available to the host Mac. You can modified the source code to force it to use other IPSW, but as currently there’s only Monterey available, we can just leave it as it is.&lt;/p&gt;

&lt;p&gt;After the installation, fire up “macOSVirtualMachineSampleApp”. It should open a window with the macOS Monterey VM we just installed.&lt;/p&gt;

&lt;h2 id=&quot;install-macos-ventura-beta&quot;&gt;Install macOS Ventura Beta&lt;/h2&gt;

&lt;p&gt;Once you have access to the VM, open Safari and download the macOS Ventura installer “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;InstallAssistant.pkg&lt;/code&gt;” &lt;a href=&quot;/blog/install-macos-ventura-beta-in-vmware-fusion#obtain-the-macos-ventura-installer&quot;&gt;here&lt;/a&gt;. At the moment, the “macOS Developer Beta Access Utility” available on the Apple Developer website will result in errors so you won’t be able to upgrade directly.&lt;/p&gt;

&lt;p&gt;Install the PKG file you just downloaded, then open the “Install macOS 13 beta.app” in your Applications folder to start the macOS installation. As macOS Ventura greatly alter the System Preferences UI, it’s recommended to have everything setup before you upgrade.&lt;/p&gt;

&lt;p&gt;Wait until the installation finish. You should now have a working macOS Ventura VM on your Apple silicon Mac.&lt;/p&gt;
</description>
                <pubDate>Thu, 09 Jun 2022 10:43:14 +0800</pubDate>
                <link>https://one.vg/blog/running-macos-ventura-in-a-virtual-machine-on-apple-silicon-macs</link>
                <guid isPermaLink="true">https://one.vg/blog/running-macos-ventura-in-a-virtual-machine-on-apple-silicon-macs</guid>
                
                <category>Mac</category>
                
                <category>Apple Silicon</category>
                
                
            </item>
        
    </channel>
</rss>